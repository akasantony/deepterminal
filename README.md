# DeepTerminal

An algorithmic trading application for futures and options, built with Python and [Textual](https://textual.textualize.io/) for a terminal-based UI.

## Features

- **Algorithmic Trading**: Implement multiple trading strategies like MACD, Stochastic RSI, EMA with different windows, CPR, etc.
- **Strategy Management**: Weighted decision making across different strategies to generate high-confidence signals.
- **Position Management**: Automated position entry, exit, stop loss and take profit management.
- **Risk Management**: Built-in risk management including position sizing, stop losses based on ATR, and more.
- **Terminal UI**: Beautiful and responsive terminal interface built with Textual.
- **Broker Agnostic**: Modular design to support multiple brokers through a common interface.
- **Backtest Engine**: Test your strategies with historical data before running them live.

## Installation

DeepTerminal uses [Poetry](https://python-poetry.org/) for dependency management.

1. Clone the repository:

```bash
git clone https://github.com/yourusername/deepterminal.git
cd deepterminal
```

2. Install dependencies using Poetry:

```bash
poetry install
```

## Usage

### Command Line Interface

DeepTerminal comes with a command-line interface with several commands:

```bash
# Run the application
poetry run deepterminal run

# Create a default configuration file
poetry run deepterminal create-config

# Authenticate with a broker
poetry run deepterminal authenticate --broker interactive_brokers

# Run a backtest
poetry run deepterminal backtest --strategy MACDStrategy --symbol AAPL --timeframe 1h --start 2023-01-01

# List all available strategies
poetry run deepterminal list-strategies
```

### Configuration

Before running DeepTerminal, you need to set up your configuration file:

1. Generate a default configuration file:

```bash
poetry run deepterminal create-config
```

2. Edit the generated file at `~/.config/deepterminal/config.toml` with your broker credentials and preferences.

### Adding a New Strategy

1. Create a new Python file in the appropriate strategy directory (e.g., `deepterminal/strategies/trend_following/my_strategy.py`)
2. Create a class that inherits from `StrategyBase`
3. Implement the required methods, especially `generate_signals()`
4. The strategy will be automatically discovered and registered

Example:

```python
from deepterminal.strategies.base import StrategyBase
from deepterminal.core.models.signal import Signal, SignalFactory, SignalStrength
from deepterminal.core.models.order import OrderSide

class MyStrategy(StrategyBase):
    """My custom trading strategy."""

    def __init__(self, *args, **kwargs):
        super().__init__(name="My Strategy", *args, **kwargs)

    def generate_signals(self, data):
        # Your strategy logic here
        signals = []

        # Example: Create a buy signal
        signal = SignalFactory.create_entry_signal(
            instrument=self.instruments[0],
            side=OrderSide.BUY,
            strategy_id=self.id,
            strength=SignalStrength.STRONG,
            entry_price=data[self.instruments[0].symbol].iloc[-1]['close'],
            stop_loss=data[self.instruments[0].symbol].iloc[-1]['close'] * 0.95,
            take_profit=data[self.instruments[0].symbol].iloc[-1]['close'] * 1.10
        )

        signals.append(signal)
        return signals
```

### Adding a New Broker

1. Create a new Python file in the exchange adapters directory (e.g., `deepterminal/exchange/adapters/my_broker.py`)
2. Create a class that inherits from `ExchangeBase`
3. Implement all required methods to interact with your broker's API

## Application Interface

DeepTerminal provides a rich terminal interface with several panels:

- **Dashboard**: Shows account information, strategy stats, and system status.
- **Positions**: Displays all current positions with P&L, entry/exit points, and risk metrics.
- **Signals**: Shows trading signals generated by the strategies.
- **Strategy Management**: Configure and activate/deactivate strategies.
- **Emergency Controls**: Quickly pause trading or close all positions.

## Project Structure

- `deepterminal/`: Main package
  - `core/`: Core business logic and domain models
  - `data/`: Data management (sources, storage, processing)
  - `exchange/`: Exchange integration and order routing
  - `indicators/`: Technical indicators implementation
  - `strategies/`: Trading strategies
  - `execution/`: Order execution engine
  - `risk/`: Risk management
  - `analytics/`: Performance analytics and reporting
  - `backtesting/`: Backtesting functionality
  - `ui/`: Terminal user interface
  - `utils/`: Utility functions
  - `config/`: Configuration management

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

This project is licensed under the MIT License - see the LICENSE file for details.
